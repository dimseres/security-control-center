# Журнал изменений

## 1.0.8 — 17.02.2026

### Исправлено

#### Мониторинг / уведомления
- Устранена `500` ошибка на `GET /api/monitoring/notifications/deliveries` при PostgreSQL.
- Причина: несовместимый placeholder в `LIMIT` для PostgreSQL.
- Исправлено: для PostgreSQL используется `LIMIT $1`, для SQLite сохранён `LIMIT ?`.

#### Инциденты / UI
- Исправлена адаптивность блока `Изменения инцидента` в модальном окне.
- Убрано «выпрыгивание» содержимого и горизонтальные переполнения на узких экранах.
- Сетка блока переведена на авто-перенос колонок внутри доступной ширины контейнера.
- Добавлены ограничения переноса длинного текста (`overflow-wrap`/`word-break`) для событий таймлайна.
- В UI инцидента `Постмортем` переименован в `Разбор после инцидента`.
- Исправлено сохранение разбора: после `PUT /api/incidents/{id}/postmortem` значение сразу отображается в форме.
- Исправлено мгновенное визуальное применение статуса инцидента в блоке `Этапы`: после сохранения статус сразу перерисовывается без перезагрузки страницы.
- Убран принудительный повторный `GET /api/incidents/{id}` после смены статуса в `Этапы`, из-за которого UI мог кратковременно откатываться к старому статусу.
- При завершении этапа добавлено автоматическое сохранение несохранённого содержимого этапа перед `complete`.
- При закрытии инцидента добавлено автоматическое сохранение несохранённых этапов перед `close`, чтобы итог решения применялся без ручного нажатия `Сохранить`.
- Для карточки решений добавлена цветовая индикация исходов (`отложено`, `под наблюдением`, `отклонено`, `блокировка` — разными цветами).
- Удалена подсказка `Введите варианты через запятую` из блока решений.
- Исправлен UI-баг селекта статуса в `Этапы`: убран эффект «отката на прошлый статус» и инвертированного отображения при повторном выборе.
- Добавлена отдельная цветовая индикация закрытых исходов в таблицах и карточках инцидентов: `отложено`, `под наблюдением`, `отклонено`, `блокировка`.
- Добавлена защита от повторного submit смены статуса и «мягкая» синхронизация при `conflictVersion` (краткий retry-read), чтобы не показывать ложную ошибку при уже применённом статусе.
- Исправлен конфликт версий при смене статуса в `Этапы`: при `conflictVersion` выполняется актуализация версии и повторное применение выбранного статуса, без ложного отката UI.
- Перед сохранением статуса в `Этапы` добавлена актуализация server-side версии инцидента, чтобы снизить `409 Conflict` в конкурирующих сценариях.
- Автосохранение инцидента теперь не запускает параллельные `PUT` во время ручной смены статуса (`statusSaving`), чтобы убрать визуальные гонки и ложные `conflictVersion`.
- Убрано ложное всплывающее сообщение об ошибке при успешной смене статуса (конфликт версии обрабатывается тихо, если сервер уже принял изменение).
- Исправлено восстановление deep-link для инцидента при `F5`: открытие по `/incidents/{id}` теперь сохраняется и после перезагрузки снова открывается этот же инцидент.
- Исправлено восстановление deep-link для задач при `F5`: `/tasks/space/{space_id}/task/{task_id}` больше не теряется до открытия модалки задачи.
- Для закрытия task-модалки кликом по backdrop/`Esc` добавлен тот же route-hook, что и у кнопки `x`: URL корректно возвращается на ссылку пространства.

### Версия
- Версия приложения обновлена до `1.0.8`.

