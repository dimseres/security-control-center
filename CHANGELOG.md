# Журнал изменений

## 1.0.9 — 18.02.2026

### Исправлено

#### Инциденты / этапы
- В этапе Завершение, в блоке Решения, в выпадающий список Решение добавлен исход Закрыт.
- Для исхода Закрыт добавлена визуальная индикация в карточке решения (нейтральный зелёный).
- Добавлена нормализация/поддержка значения closed на клиенте и сервере для closure_outcome.
- Для закрытых инцидентов с исходом closed сохранён базовый зелёный статус без отдельного суффиксного класса.
- Разрешено удаление инцидентов со статусом closed через DELETE /api/incidents/{id} (без 409 для закрытых).
- В списке инцидентов добавлена кнопка удаления (x) с подтверждением.
- Добавлен endpoint POST /api/incidents/cleanup для массовой очистки инцидентов (scope: open/completed/period/all, source, from/to) с аудитом incident.cleanup.
- В настройках добавлен отдельный блок Очистка мониторинга (по открытым, завершенным, либо периоду) на базе incident cleanup с source=monitoring.
- Очистка вкладок для инцидентов переведена на серверный cleanup endpoint, чтобы корректно удалялись и закрытые инциденты.
- Автозакрытие инцидентов мониторинга теперь тихо игнорирует конфликт удаления/состояния (ErrConflict) и не логирует ложную ошибку.
- В уведомления мониторинга (down) добавлен вывод причины ошибки проверки (включая HTTP status и ключевые ошибки мониторинга).
- Документация обновлена: добавлен отдельный документ по настройке `message` шаблона уведомлений мониторинга (`docs/ru/monitoring_notifications_message_template.md`, `docs/eng/monitoring_notifications_message_template.md`) и ссылки в README.
- Исправлено раскрытие токена Telegram-канала уведомлений: кнопка `глаз` теперь получает и показывает реальный токен (по защищенному endpoint с правами `monitoring.notifications.manage` и аудитом `monitoring.notification.channel.reveal_token`).
- Исправлена повреждённая локализация в мониторинговых уведомлениях (RU/EN строки в сообщениях `down/up/tls` и ошибках проверки).

#### Мониторинг / UI
- При редактировании монитора (смена адреса/настроек) статус и график теперь обновляются без ручного pause/resume: состояние помечается как due и выполняется ускоренная проверка с ретраями при busy.
- При копировании монитора копируются привязки уведомлений (чекбоксы) и корректно генерируется новый токен для пассивных (push) мониторов.
- После копирования монитора UI ждёт первую проверку и автоматически обновляет детали/график без `F5`.
- Deep-link для мониторов: URL теперь синхронизируется с выбранным монитором через `?monitor={id}` (выбор/создание/копирование/удаление).
- Исправлено восстановление (UP) уведомлений: сообщение о том, что монитор ожил, больше не подавляется общим `notify_suppress_minutes` сразу после DOWN.
